<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#000000">
    <title>FITIA DEX | Pro Exchange</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
</head>
<body>

    <div class="neon-bg"></div>
    <div id="toast-container"></div>

    <!-- MODAL: SÃ©lection de Token -->
    <div id="modal-tokens" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3>SÃ©lectionner un token</h3>
                <button class="modal-close" onclick="App.closeModal()">&times;</button>
            </div>
            <input type="text" id="search-token" class="search-input" placeholder="Rechercher ou coller adresse" oninput="App.filterTokens()">
            <div id="token-list" class="token-list"></div>
        </div>
    </div>

    <div class="app-shell">
        
        <!-- Header -->
        <header class="dex-header">
            <div class="brand">
                <div class="logo-icon">ðŸ’±</div>
                <div>
                    <div class="logo-text">FITIA DEX</div>
                    <div class="logo-sub">PRO EXCHANGE</div>
                </div>
            </div>
            <button id="btn-connect" class="btn-glass" onclick="App.connect()">Connecter</button>
            <div id="wallet-status" class="wallet-info hidden">
                <span id="addr-display">0x...</span>
                <span class="status-dot"></span>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="bottom-dex-nav">
            <button class="nav-dex-btn active" onclick="App.setView('trade')">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"/></svg>
                <span>Trade</span>
            </button>
            <button class="nav-dex-btn" onclick="App.setView('pool')">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg>
                <span>Pools</span>
            </button>
            <button class="nav-dex-btn" onclick="App.setView('stake')">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M2 20h2c.55 0 1-.45 1-1v-9c0-.55-.45-1-1-1H2v11zm19.83-7.12c.11-.25.17-.52.17-.8V11c0-1.1-.9-2-2-2h-5.5l.92-4.65c.05-.22.02-.46-.08-.66-.23-.45-.52-.86-.88-1.22L14 2 7.39 8.61C7.15 8.85 7 9.16 7 9.5V19c0 1.1.9 2 2 2h7.11c.71 0 1.35-.38 1.71-1l3.01-7.12z"/></svg>
                <span>Stake</span>
            </button>
            <button class="nav-dex-btn" onclick="App.setView('wallet')">
                <svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                <span>Wallet</span>
            </button>
        </nav>

        <main class="dex-main">
            
            <!-- VUE: TRADE (SWAP) -->
            <section id="view-trade" class="view-section active">
                <div class="card swap-card">
                    <div class="input-box">
                        <div class="input-header">
                            <span>Vous payez</span>
                            <span class="balance-link" onclick="App.setMax()">Solde: <span id="bal-from">0</span></span>
                        </div>
                        <div class="input-row">
                            <input type="number" id="amount-in" placeholder="0.0" oninput="App.calcRate()">
                            <div class="token-selector" onclick="App.openModal('from')">
                                <img id="img-from" src="" alt="" class="token-img hidden">
                                <span id="sym-from">FTA</span>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M7 10l5 5 5-5z"/></svg>
                            </div>
                        </div>
                    </div>

                    <div class="switch-wrap">
                        <button class="switch-btn" onclick="App.switchTokens()">â‡…</button>
                    </div>

                    <div class="input-box" style="margin-top:0;">
                        <div class="input-header">
                            <span>Vous recevez</span>
                            <span class="balance-link">Solde: <span id="bal-to">0</span></span>
                        </div>
                        <div class="input-row">
                            <input type="number" id="amount-out" placeholder="0.0" readonly>
                            <div class="token-selector" onclick="App.openModal('to')">
                                <img id="img-to" src="" alt="" class="token-img hidden">
                                <span id="sym-to">USDT</span>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M7 10l5 5 5-5z"/></svg>
                            </div>
                        </div>
                    </div>

                    <div class="rate-display" id="rate-info">Chargement...</div>
                    <button id="btn-swap" class="btn-main" onclick="App.executeSwap()">Connectez-vous</button>
                </div>
            </section>

            <!-- VUE: POOLS (LiquiditÃ©) -->
            <section id="view-pool" class="view-section">
                <div class="card">
                    <h3 class="card-title">ðŸŒŠ Pools de LiquiditÃ©</h3>
                    <p style="font-size:0.85rem; color:var(--text-muted); margin-bottom:15px;">Fournissez des tokens pour gagner des frais sur les Ã©changes.</p>
                    
                    <div id="lp-list">
                        <!-- Liste gÃ©nÃ©rÃ©e par JS -->
                    </div>
                    
                    <button class="btn-main btn-secondary" onclick="App.setView('add')" style="margin-top:15px">+ CrÃ©er une position</button>
                </div>
            </section>

            <!-- VUE: ADD LIQUIDITY -->
            <section id="view-add" class="view-section">
                <div class="card">
                    <div class="flex-between" style="margin-bottom:20px;">
                        <h3 class="card-title" style="margin:0">âž• Ajouter</h3>
                        <button class="btn-glass" style="padding:8px" onclick="App.setView('pool')">âœ• Retour</button>
                    </div>

                    <div class="input-box">
                        <div class="input-header"><span>Token 1</span><span id="lp-bal1">0</span></div>
                        <div class="input-row">
                            <input type="number" id="lp-amt1" placeholder="0.0" oninput="App.calcLp()">
                            <div class="token-selector" onclick="App.openModal('lp1')"><span id="lp-sym1">FTA</span></div>
                        </div>
                    </div>

                    <div class="input-box" style="margin-top:10px;">
                        <div class="input-header"><span>Token 2</span><span id="lp-bal2">0</span></div>
                        <div class="input-row">
                            <input type="number" id="lp-amt2" placeholder="0.0" oninput="App.calcLp(true)">
                            <div class="token-selector" onclick="App.openModal('lp2')"><span id="lp-sym2">USDT</span></div>
                        </div>
                    </div>

                    <div class="lp-info-box">
                        <div class="flex-between"><span>Prix:</span><span id="lp-price">-</span></div>
                        <div class="flex-between"><span>Part du pool:</span><span id="lp-share">-%</span></div>
                    </div>

                    <button class="btn-main" onclick="App.addLiquidity()">Fournir</button>
                </div>
            </section>

            <!-- VUE: STAKING -->
            <section id="view-stake" class="view-section">
                <div class="card">
                    <h3 class="card-title">ðŸš€ Staking (Farming)</h3>
                    <p style="font-size:0.85rem; color:var(--text-muted); margin-bottom:15px;">Verrouillez vos tokens pour gagner des rÃ©compenses.</p>
                    
                    <div id="stake-list">
                        <!-- Liste gÃ©nÃ©rÃ©e par JS -->
                    </div>
                </div>
            </section>

            <!-- VUE: WALLET (Portfolio) -->
            <section id="view-wallet" class="view-section">
                <div class="card">
                    <h3 class="card-title">ðŸ’¼ Mon Portfolio</h3>
                    <div id="wallet-list" class="wallet-grid">
                        <!-- Liste gÃ©nÃ©rÃ©e par JS -->
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Loader -->
    <div id="loader" class="loader hidden">
        <div class="spinner"></div>
        <p id="loader-text">Chargement...</p>
    </div>

    <script src="app.js"></script>
</body>
</html>
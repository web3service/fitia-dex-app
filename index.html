<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FITIA MINER V2</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
</head>
<body>

    <!-- OVERLAY DE CHARGEMENT -->
    <div id="loader" class="loader-overlay">
        <div class="spinner"></div>
        <p id="loader-msg">Connexion...</p>
    </div>

    <!-- NOTIFICATIONS -->
    <div id="toast-container"></div>

    <!-- HEADER -->
    <header>
        <div class="logo">FITIA <span>V2</span></div>
        <button id="btn-connect" class="btn-connect" onclick="app.connectWallet()">Connecter</button>
        <div id="wallet-info" class="wallet-info hidden">
            <span id="user-addr">0x...</span>
            <div class="balances-mini">
                <small id="mini-usdt">0 USDT</small>
                <small id="mini-fta">0 FTA</small>
            </div>
        </div>
    </header>

    <!-- CONTENU PRINCIPAL -->
    <main id="main-content">
        
        <!-- ONGLET: ACCUEIL -->
        <section id="tab-home" class="tab-content active">
            <!-- Parrainage -->
            <div class="card referral-box">
                <h3>Code Parrain</h3>
                <p style="font-size:0.8rem; color:#aaa; margin-bottom:10px;">Entrez l'adresse de votre parrain pour activer les bonus.</p>
                <div class="input-row">
                    <input type="text" id="ref-input" placeholder="0x..." readonly>
                    <button class="btn-small" onclick="app.copyRef()">Copier Mon Lien</button>
                </div>
                <div id="set-ref-section" style="margin-top:10px; display:none;">
                    <input type="text" id="new-ref-input" placeholder="Adresse parrain √† lier">
                    <button class="btn-small" style="width:100%; margin-top:5px; background:var(--accent);" onclick="app.setReferrer()">LIER PARRAIN</button>
                </div>
            </div>

            <!-- Stats -->
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-label">PUISSANCE</span>
                    <span class="stat-val" id="val-power">0.00</span>
                    <span class="stat-unit">FTA/s</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">GAINS</span>
                    <span class="stat-val" id="val-rewards">0.00</span>
                    <span class="stat-unit">FTA</span>
                </div>
            </div>

            <!-- Action -->
            <button class="btn-action" onclick="app.claimRewards()">
                ‚ö° R√âCLAMER
            </button>

            <!-- Logs -->
            <div class="card">
                <h3>Activit√©</h3>
                <ul id="activity-log" class="log-list">
                    <li>En attente de connexion...</li>
                </ul>
            </div>
        </section>

        <!-- ONGLET: BOUTIQUE -->
        <section id="tab-shop" class="tab-content">
            <h2>Rigs Disponibles</h2>
            <div id="shop-container" class="shop-grid">
                <!-- Rempli par JS -->
                <p>Chargement...</p>
            </div>
        </section>

        <!-- ONGLET: SWAP -->
        <section id="tab-swap" class="tab-content">
            <h2>√âchange</h2>
            <div class="card swap-box">
                <div class="swap-row">
                    <label>Payer</label>
                    <div class="input-group">
                        <input type="number" id="swap-from-amount" placeholder="0.0" oninput="app.calcSwap()">
                        <select id="swap-from-token" onchange="app.flipSwap()">
                            <option value="USDT">USDT</option>
                            <option value="FTA">FTA</option>
                        </select>
                    </div>
                    <small class="balance-display">Solde: <span id="bal-from">0</span></small>
                </div>

                <div class="swap-icon" onclick="app.flipSwap()">‚áÖ</div>

                <div class="swap-row">
                    <label>Recevoir</label>
                    <div class="input-group">
                        <input type="number" id="swap-to-amount" placeholder="0.0" readonly>
                        <select id="swap-to-token" disabled>
                            <option value="FTA">FTA</option>
                            <option value="USDT">USDT</option>
                        </select>
                    </div>
                    <small class="balance-display">Solde: <span id="bal-to">0</span></small>
                </div>

                <button class="btn-primary" onclick="app.executeSwap()">√âCHANGER</button>
                <div id="rate-display" style="text-align:center; margin-top:10px; font-size:0.8rem; color:#888;"></div>
            </div>
        </section>

        <!-- ONGLET: INVENTAIRE -->
        <section id="tab-inventory" class="tab-content">
            <h2>Mes Rigs</h2>
            <div id="inventory-container">
                <p style="text-align:center; color:#666;">Connectez-vous pour voir vos machines.</p>
            </div>
        </section>

    </main>

    <!-- NAVIGATION BAS -->
    <nav class="bottom-nav">
        <button class="nav-item active" onclick="app.switchTab('home')">
            <span class="icon">üè†</span>
            <span class="label">Accueil</span>
        </button>
        <button class="nav-item" onclick="app.switchTab('shop')">
            <span class="icon">üõí</span>
            <span class="label">Boutique</span>
        </button>
        <button class="nav-item" onclick="app.switchTab('swap')">
            <span class="icon">üîÑ</span>
            <span class="label">Swap</span>
        </button>
        <button class="nav-item" onclick="app.switchTab('inventory')">
            <span class="icon">üì¶</span>
            <span class="label">Inventaire</span>
        </button>
    </nav>

    <script src="script.js"></script>
</body>
</html>
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0f172a">
    <title>FITIA PRO MINER</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
</head>
<body>

    <div class="bg-glow"></div>
    <div id="toast-container"></div>

    <div class="app-shell">
       
        <!-- HEADER -->
        <header>
            <div class="brand">
                <div class="logo-icon">‚ö°</div>
                <div class="brand-text">FITIA <span class="pro-badge">PRO</span></div>
            </div>
            <button id="btn-connect" class="btn-connect" onclick="App.connect()">Connecter</button>
            <div id="wallet-status" class="wallet-status hidden">
                <span id="addr-display">0x...</span>
                <span class="status-dot"></span>
            </div>
        </header>

        <!-- MAIN CONTENT -->
        <main id="main-view">
           
            <!-- DASHBOARD -->
            <div id="view-dashboard" class="view active">
               
                <!-- PARRAINAGE -->
                <div class="card referral-card">
                    <h3>üë• Syst√®me de Parrainage</h3>
                    <p class="small-text">Gagnez des commissions sur 3 niveaux.</p>
                    <div class="input-group" onclick="App.copyLink()">
                        <input type="text" id="ref-link" readonly value="Connectez-vous...">
                        <button class="icon-btn">üìã</button>
                    </div>
                    <div id="bind-ref-area" style="display:none; margin-top:15px;">
                        <p class="small-text">Parrain d√©tect√© : <span id="detected-ref" class="highlight"></span></p>
                        <button class="btn-sm btn-full" onclick="App.bindReferrer()">LIER MON PARRAIN</button>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <small>PUISSANCE</small>
                        <div class="stat-val" id="val-power">0.00000</div>
                        <small>FTA / sec</small>
                    </div>
                    <div class="stat-card accent">
                        <small>EN ATTENTE</small>
                        <div class="stat-val" id="val-pending">0.00000</div>
                        <small>FTA</small>
                    </div>
                </div>

                <div class="visualizer-wrap">
                    <canvas id="mining-canvas"></canvas>
                    <div class="viz-label" id="viz-status">EN ATTENTE</div>
                </div>

                <button class="btn-mega" onclick="App.claim()">
                    <span class="pulse-ring"></span>
                    R√âCLAMER
                </button>

                <!-- BALANCES CARD MODIFIEE AVEC LOGOS -->
                <div class="card balances-card">
                    <!-- USDT -->
                    <div class="row-between" style="align-items: center;">
                        <span style="display:flex; align-items:center; gap:8px;">
                            <img src="https://cryptologos.cc/logos/tether-usdt-logo.png" class="token-logo" alt="USDT">
                            USDT
                        </span>
                        <span class="balance" id="bal-usdt">0.00</span>
                    </div>
                    <!-- FTA -->
                    <div class="row-between" style="margin-top:12px; align-items: center;">
                        <span style="display:flex; align-items:center; gap:8px;">
                            <img id="logo-fta-bal" src="https://i.ibb.co/vvz2DDK5/20260207-190817.webp" class="token-logo" alt="FTA">
                            FTA
                        </span>
                        <span class="balance" id="bal-fta">0.00</span>
                    </div>
                </div>
            </div>

            <!-- SHOP -->
            <div id="view-shop" class="view">
                <div class="shop-header">
                    <h2 class="view-title">‚õèÔ∏è Boutique</h2>
                    <div class="toggle-pay">
                        <button id="btn-pay-usdt" class="toggle-btn active" onclick="App.setPayMode('USDT')">USDT</button>
                        <button id="btn-pay-fta" class="toggle-btn" onclick="App.setPayMode('FTA')">FTA</button>
                    </div>
                </div>
                <div id="shop-list" class="grid-list"></div>
            </div>

            <!-- MY RIGS -->
            <div id="view-my-rigs" class="view">
                <h2 class="view-title">‚öôÔ∏è Mes Machines</h2>
                <div id="my-rigs-list" class="rigs-list-container"></div>
                <div id="no-rigs" class="card" style="text-align:center; display:none;">
                    <p>Vous n'avez pas encore de machines actives.</p>
                </div>
            </div>

            <!-- GAMES -->
            <div id="view-games" class="view">
                <h2 class="view-title">üéÆ Game Center</h2>
                
                <div class="game-tabs">
                    <button class="game-tab active" onclick="App.showGame('wingo')">Win Go</button>
                    <button class="game-tab" onclick="App.showGame('wheel')">Roue</button>
                    <button class="game-tab" onclick="App.showGame('fishing')">P√™che</button>
                    <button class="game-tab" onclick="App.showGame('lottery')">Loterie</button>
                </div>

                <!-- Win Go -->
                <div id="game-wingo" class="game-area active">
                    <p class="game-info">Deviner le num√©ro (0-9) ou Grand/Petit.</p>
                    
                    <div class="slot-machine">
                        <div class="slot-window">
                            <div class="slot-reel" id="slot-reel">
                                <span>5</span><span>0</span><span>1</span><span>2</span><span>3</span><span>4</span><span>5</span><span>6</span><span>7</span><span>8</span><span>9</span><span>0</span>
                            </div>
                        </div>
                    </div>
                    <div id="wingo-result" class="game-result-box hidden"></div>

                    <input type="number" id="wingo-bet" class="game-input" placeholder="Mise en FTA">
                    <div class="game-options">
                        <button onclick="App.playWinGo(1, 0)">Petit (0-4)</button>
                        <button onclick="App.playWinGo(1, 1)">Grand (5-9)</button>
                    </div>
                </div>

                <!-- Roue -->
                <div id="game-wheel" class="game-area">
                    <p class="game-info">Tournez pour tenter de gagner le Jackpot !</p>
                    
                    <div class="wheel-container">
                        <div class="wheel-pointer">‚ñº</div>
                        <canvas id="wheel-canvas" width="300" height="300"></canvas>
                    </div>
                    <div id="wheel-result" class="game-result-box hidden"></div>
                    
                    <div class="jackpot-display">Jackpot: <span id="wheel-jackpot">0</span> FTA</div>
                    <button class="btn-game" onclick="App.spinWheel()">Tourner (100 FTA)</button>
                </div>

                <!-- P√™che -->
                <div id="game-fishing" class="game-area">
                    <p class="game-info">Lancez votre ligne pour attraper des gains.</p>
                    
                    <div class="fishing-container">
                        <div class="fishing-line" id="fishing-line"></div>
                        <div class="fishing-hook" id="fishing-hook">ü™ù</div>
                    </div>
                    <div id="fishing-status" class="fishing-status">En attente...</div>
                    <div id="fish-result" class="game-result-box hidden"></div>
                    
                    <button class="btn-game" onclick="App.goFishing()">P√™cher (50 FTA)</button>
                </div>

                <!-- Loterie -->
                <div id="game-lottery" class="game-area">
                    <p class="game-info">Achetez un ticket pour participer au tirage.</p>
                    <div class="jackpot-display">Pot: <span id="lottery-pot">0</span> FTA</div>
                    <button class="btn-game" onclick="App.buyLotteryTicket()">Acheter Ticket (50 FTA)</button>
                </div>
            </div>

            <!-- SWAP -->
            <div id="view-swap" class="view">
                <h2 class="view-title">üí± √âchange</h2>
                <div class="card swap-interface">
                    <div class="swap-header">
                        <span>Vous payez</span>
                        <span>Solde: <span id="swap-bal-from">0</span></span>
                    </div>
                    <div class="input-wrap">
                        <input type="number" id="swap-from-in" placeholder="0.0" oninput="App.calcSwap()">
                        <div class="token-select" onclick="App.toggleSwap()" id="token-from-display">USDT</div>
                    </div>
                    <div class="swap-arrow-wrap">
                        <div class="swap-arrow" onclick="App.toggleSwap()">‚áÖ</div>
                    </div>
                    <div class="swap-header">
                        <span>Vous recevez</span>
                        <span>Solde: <span id="swap-bal-to">0</span></span>
                    </div>
                    <div class="input-wrap">
                        <input type="number" id="swap-to-in" placeholder="0.0" readonly>
                        <div class="token-select" style="background:#333; cursor:default;" id="token-to-display">FTA</div>
                    </div>
                    <div class="rate-info" id="swap-rate">Chargement...</div>
                    <button class="btn-primary" onclick="App.executeSwap()">√âCHANGER</button>
                </div>
            </div>

        </main>

        <!-- NAVIGATION -->
        <nav class="bottom-nav">
            <button class="nav-item active" onclick="App.nav('dashboard')">
                <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
                <span>Home</span>
            </button>
            <button class="nav-item" onclick="App.nav('shop')">
                <svg viewBox="0 0 24 24"><path d="M12 2l-5.5 9h11z"/></svg>
                <span>Shop</span>
            </button>
            <button class="nav-item" onclick="App.nav('my-rigs')">
                <svg viewBox="0 0 24 24"><path d="M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2H0v2h24v-2h-4zM4 6h16v10H4V6z"/></svg>
                <span>Mes Rigs</span>
            </button>
            <button class="nav-item" onclick="App.nav('games')">
                <svg viewBox="0 0 24 24"><path d="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v3H6v-3H3v-2h3V8h2v3h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                <span>Jeux</span>
            </button>
            <button class="nav-item" onclick="App.nav('swap')">
                <svg viewBox="0 0 24 24"><path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"/></svg>
                <span>Swap</span>
            </button>
        </nav>

    </div>

    <div id="loader" class="loader hidden">
        <div class="spinner-ring"></div>
        <p id="loader-text">Traitement...</p>
    </div>

    <script src="app.js"></script>
</body>
</html>